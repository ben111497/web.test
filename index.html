<!DOCTYPE html>
<html>
<head>
    <title>週表格</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }

        table, th, td {
            border: 1px solid black;
        }

        th, td {
            text-align: center;
            padding: 10px;
        }

        th:first-child, td:first-child {
            background-color: white;
        }
    </style>
</head>
<body>
    <div style="height:50px">
        <label style="height:100%;font-size: 20px;" for="weekNumberInput">本週號碼 (1-8): </label>
        <input style="width:100px;height:90%;font-size: 20px;text-align: center;"type="number" id="weekNumberInput" min="1" max="8" value="1">
        <button style="width:100px;height:100%;" onclick="generateTable()">更新</button>
    </div>
    <div style="width:100%;height:20px"></div>
    <table id="weekTable">
        <tr>
            <th>週別</th>
            <th>號碼</th>
            <th>上班日期＆時間</th>
        </tr>
    </table>

    <script>
          function getTime(week) {
            let list = [
                [0,0,0,1,0,1,1,1,0,0,1,1,1,1,0,1,1,0],
                [1,1,0,1,0,1,1,0,0,1,0,0,1,0,1,1,1,0],
                [1,1,0,0,1,1,0,0,0,1,0,1,1,1,0,1,1,0],
                [1,1,0,0,1,1,0,1,1,1,1,0,1,1,0,0,0,0],
                [0,1,1,1,1,0,1,1,1,0,0,0,1,1,0,1,1,0],
                [1,0,1,1,1,0,1,1,0,1,1,0,1,0,1,0,0,0],
                [1,0,0,1,1,0,1,0,1,1,1,0,0,1,1,1,0,0],
                [1,0,1,1,1,0,1,0,0,1,0,1,0,1,1,1,1,0]
            ][week - 1];
            console.log(`list: ${list}`)
        

            return `<table>
                <tr style="background-color: #B2EBD8;">
                    <th style="background-color: #AAAAAA;"></th>
                    <th>一</th>
                    <th>二</th>
                    <th>三</th>
                    <th>四</th>
                    <th>五</th>
                    <th>六</th>
                </tr>
                <tr>
                    <td style="background-color: #87cefa;">早</td>
                    <td>${list[0] === 1 ? "☑️" : ""}</td>
                    <td>${list[3] === 1 ? "☑️" : ""}</td>
                    <td>${list[6] === 1 ? "☑️" : ""}</td>
                    <td>${list[9] === 1 ? "☑️" : ""}</td>
                    <td>${list[12] === 1 ? "☑️" : ""}</td>
                    <td>${list[15] === 1 ? "☑️" : ""}</td>
                </tr>
                <tr>
                    <td style="background-color: #87cefa;">午</td>
                    <td>${list[1] === 1 ? "☑️" : ""}</td>
                    <td>${list[4] === 1 ? "☑️" : ""}</td>
                    <td>${list[7] === 1 ? "☑️" : ""}</td>
                    <td>${list[10] === 1 ? "☑️" : ""}</td>
                    <td>${list[13] === 1 ? "☑️" : ""}</td>
                    <td>${list[16] === 1 ? "☑️" : ""}</td>
                </tr>
                <tr>
                    <td style="background-color: #87cefa;">晚</td>
                    <td>${list[2] === 1 ? "☑️" : ""}</td>
                    <td>${list[5] === 1 ? "☑️" : ""}</td>
                    <td>${list[8] === 1 ? "☑️" : ""}</td>
                    <td>${list[11] === 1 ? "☑️" : ""}</td>
                    <td>${list[14] === 1 ? "☑️" : ""}</td>
                    <td>${list[17] === 1 ? "☑️" : ""}</td>
                </tr>
            </table>`;
        }

        function generateTable() {
            const table = document.getElementById("weekTable");
            table.innerHTML = "<tr><th>周別</th><th>號碼</th><th>診次</th></tr>";

            const startDate = new Date();
            startDate.setDate(startDate.getDate() - (startDate.getDay() - 1));
            const endDate = new Date(startDate);
            endDate.setDate(endDate.getDate() + 6);

            const oneYearLater = new Date();
            oneYearLater.setFullYear(oneYearLater.getFullYear() + 1);

            const weekNumberInput = document.getElementById("weekNumberInput");
            let weekNumber = parseInt(weekNumberInput.value);

            while (endDate <= oneYearLater) {
                const row = document.createElement("tr");
                const dateCell = document.createElement("td");
                const weekCell = document.createElement("td");
                const timeCell = document.createElement("td");

                const startDateFormatted = startDate.toISOString().slice(0, 10);
                const endDateFormatted = endDate.toISOString().slice(0, 10);

                dateCell.style.width = "25vw";
                weekCell.style.width = "10vw";
                timeCell.style.width = "60vw";

                dateCell.textContent = startDateFormatted + " -> " + endDateFormatted;
                weekCell.textContent = weekNumber;
                timeCell.innerHTML = getTime(weekNumber);

                row.appendChild(dateCell);
                row.appendChild(weekCell);
                row.appendChild(timeCell);

                table.appendChild(row);

                startDate.setDate(startDate.getDate() + 7);
                endDate.setDate(endDate.getDate() + 7);
                weekNumber = weekNumber % 8 + 1;

                if (startDate > oneYearLater) {
                    break;
                }
            }
        }

        //generateTable();
    </script>
</body>
</html>
